<!DOCTYPE html>
<html>
<head>
<style>
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
}  
    
#chartdiv {
  width: 100%;
  height: 500px;
}  

	#alphabet-nav {
  flex-wrap: wrap;
  gap: 4px;
}
</style>  


<script src="https://cdn.amcharts.com/lib/4/core.js"></script>
<script src="https://cdn.amcharts.com/lib/4/charts.js"></script>
<script src="https://cdn.amcharts.com/lib/4/themes/animated.js"></script>

<link href="https://cdn.datatables.net/2.3.2/css/dataTables.dataTables.css" rel="stylesheet">
	
  <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
   <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/2.3.2/js/dataTables.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
  
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">
        <title>SO-TagNavigator</title>
  
    </head> 
    <body>
     <nav class="navbar navbar-expand-lg fixed-top bg-body-tertiary bg-dark  " data-bs-theme="dark">
  <div class="container-fluid">
    <a class="navbar-brand" href="#">Stack Overflow Tag Navigator</a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav me-auto mb-2 mb-lg-0">
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="https://stackoverflow.com/tags" target="_blank" data-bs-placement="bottom" title="Leads to Stack Overflow site">Existing Interface</a>
        </li>
        <li class="nav-item">
          <a class="nav-link active" aria-current="page" href="#">Minimal Changes</a>
        </li>
<!--         <li class="nav-item">
          <a class="nav-link" href="#">Link</a>
        </li> -->
        <li class="nav-item dropdown">
          <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
            Leveraging Morphological Similarity
          </a>
          <ul class="dropdown-menu">
            <li><a class="dropdown-item" href="#">Algorithm 1</a></li>
            <li><a class="dropdown-item" href="#">Algorithm 2</a></li>
            <li><hr class="dropdown-divider"></li>
            <li><a class="dropdown-item" href="#">Algorithm 3</a></li>
          </ul>
        </li>
        <li class="nav-item">
          <a class="nav-link disabled" aria-disabled="true">Disabled</a>
        </li>
      </ul>
<!--       <form class="d-flex" role="search">
        <input class="form-control me-2" type="search" placeholder="Search" aria-label="Search"/>
        <button class="btn btn-outline-success" type="submit">Search</button>
      </form> -->
    </div>
  </div>
</nav>
        <h3 style="padding-top:90px">
          Minimal Changes in Stack Overflow Tags Interface
        </h3><p >Without leveraging <b> implicit morphological, categorical or chronological information </b> assiociated with Stack Overflow Tags, we only designed an alternate interface to list down tags based on the following (bare minimum) improvements</p>
      <ul>
        <li>Allowing user to adjust the number of records to be displayed e.g. 10, 25, 50, 100</li>
        <li>Jump to any alphabet to see all tags starting from that alphabet</li>
        <li>Search a tag based on Wiki Definition and Excerpt Post</li>
        <li>Sort tags based on Tag Count</li>
      </ul>


	    <div id="alphabet-nav" class="btn-group btn-group-sm mb-2" role="group" aria-label="Alphabet Search"></div>

      <table id="tagsTable" class="display" >
    <thead>
      <tr>
        <th>Tag Name</th>
        <th>Tag Count</th>  <th>Excerpt Exists</th>
        <th>Tag Excerpt</th>
       <th>Wiki Post Exists</th>
        <th>Wiki Post </th>
        <th> </th>
       
      </tr>
    </thead>
  </table>
      


  <!-- Dependencies -->
<!--   <script src="https://code.jquery.com/jquery-3.7.0.min.js"></script> -->
 

      
<div id="chartdiv"></div>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>

    </body>
<script>
// Themes begin
am4core.useTheme(am4themes_animated);
// Themes end 



var chart = am4core.create('chartdiv', am4charts.XYChart)
chart.colors.step = 2;

chart.legend = new am4charts.Legend()
chart.legend.position = 'top'
chart.legend.paddingBottom = 20
chart.legend.labels.template.maxWidth = 95

var xAxis = chart.xAxes.push(new am4charts.CategoryAxis())
xAxis.dataFields.category = 'category'
xAxis.renderer.cellStartLocation = 0.1
xAxis.renderer.cellEndLocation = 0.9
xAxis.renderer.grid.template.location = 0;

var yAxis = chart.yAxes.push(new am4charts.ValueAxis());
yAxis.min = 0;

function createSeries(value, name) {
    var series = chart.series.push(new am4charts.ColumnSeries())
    series.dataFields.valueY = value
    series.dataFields.categoryX = 'category'
    series.name = name

    series.events.on("hidden", arrangeColumns);
    series.events.on("shown", arrangeColumns);

    var bullet = series.bullets.push(new am4charts.LabelBullet())
    bullet.interactionsEnabled = false
    bullet.dy = 30;
    bullet.label.text = '{valueY}'
    bullet.label.fill = am4core.color('#ffffff')

    return series;
}

chart.data = [
    {
        category: 'Place #1',
        first: 40,
        second: 55,
        third: 60
    },
    {
        category: 'Place #2',
        first: 30,
        second: 78,
        third: 69
    },
    {
        category: 'Place #3',
        first: 27,
        second: 40,
        third: 45
    },
    {
        category: 'Place #4',
        first: 50,
        second: 33,
        third: 22
    }
]


createSeries('first', 'The First');
createSeries('second', 'The Second');
createSeries('third', 'The Third');

function arrangeColumns() {

    var series = chart.series.getIndex(0);

    var w = 1 - xAxis.renderer.cellStartLocation - (1 - xAxis.renderer.cellEndLocation);
    if (series.dataItems.length > 1) {
        var x0 = xAxis.getX(series.dataItems.getIndex(0), "categoryX");
        var x1 = xAxis.getX(series.dataItems.getIndex(1), "categoryX");
        var delta = ((x1 - x0) / chart.series.length) * w;
        if (am4core.isNumber(delta)) {
            var middle = chart.series.length / 2;

            var newIndex = 0;
            chart.series.each(function(series) {
                if (!series.isHidden && !series.isHiding) {
                    series.dummyData = newIndex;
                    newIndex++;
                }
                else {
                    series.dummyData = chart.series.indexOf(series);
                }
            })
            var visibleCount = newIndex;
            var newMiddle = visibleCount / 2;

            chart.series.each(function(series) {
                var trueIndex = chart.series.indexOf(series);
                var newIndex = series.dummyData;

                var dx = (newIndex - trueIndex + middle - newMiddle) * delta

                series.animate({ property: "dx", to: dx }, series.interpolationDuration, series.interpolationEasing);
                series.bulletsContainer.animate({ property: "dx", to: dx }, series.interpolationDuration, series.interpolationEasing);
            })
        }
    }
}</script>

<!--   <script>
    $(document).ready(function () {
      const filterChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789._#+-$*~'.split('');
      const alphabetContainer = $('#alphabetSearch');

      // Add "All" button first
      alphabetContainer.append(`<span data-letter="All">All</span>`);
      filterChars.forEach(ch => {
        alphabetContainer.append(`<span data-letter="${ch}">${ch}</span>`);
      });

      const table = $('#tagsTable').DataTable({
        // ajax: '/MinimalChangesData.txt',
        ajax: '/MinimalChangesData_TagsPosts.json',
          
        dataSrc: '',
        columns: [
          { data: 2 }, // TagName
          { data: 3 }, // TagCount
 
          {
            data: 5, // ExcerptBody
            render: data => data?.trim() ? 'Yes' : 'No'
          },
          {
            data: 5, // ExcerptBody
            render: function (data) {
              if (data?.trim()) {
                const escaped = $('<div>').text(data).html(); // plain text escape
                const short = escaped.length > 100 ? escaped.substring(0, 100) + '…' : escaped;
                return `<span class="tooltip-text" title="${escaped}">${short}</span>`;
              }
              return '<i>(no excerpt)</i>';
            }
          },

          {
            data: 7, // WikiBody
            render: data => data?.trim() ? 'Yes' : 'No'
          },
          {
            data: 7, // WikiBody (raw HTML rendered safely)
            render: function (data) {
              if (data?.trim()) {
                const cleanHTML = DOMPurify.sanitize(data); // remove any <script>, etc.
                const tempDiv = document.createElement('div');
                tempDiv.innerHTML = cleanHTML;
                const plainText = tempDiv.textContent || tempDiv.innerText || '';
                const short = cleanHTML.length > 100 ? cleanHTML.substring(0, 100) + '…' : cleanHTML;

                return `<span class="tooltip-text" title="${plainText}">${short}</span>`;
              }
              return '<i>(no wiki)</i>';
            }
          }
        ]
      });

      // Handle filter clicks
      $('#alphabetSearch').on('click', 'span', function () {
        $('#alphabetSearch span').removeClass('active');
        $(this).addClass('active');

        const letter = $(this).data('letter');
        if (letter === 'All') {
          table.column(0).search('').draw();
        } else {
          const escaped = letter.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
          table.column(0).search('^' + escaped, true, false).draw();
        }
      });
    });
  </script> -->


    <script>
// 	var _alphabetSearch = '';
    
// 	    $.fn.dataTable.ext.search.push( function ( settings, searchData ) {
// 		    console.log("inside search");
//     if ( ! _alphabetSearch ) {
//         return true;
//     }
 
//     if ( searchData[0].charAt(0) === _alphabetSearch ) {
//         return true;
//     }
 
//     return false;
// } );
 
    $(document).ready(function() {
      var table = $('#tagsTable').DataTable({
        ajax: 'MinimalChangesData_TagsPosts.json',
        columns: [
	          { data: 2 },  // TagName
	          { data: 3 },  // TagCount
	          { data: 7,
	            	render: function (data) {
	              	return data.trim() ? '✔️' : '❌';
	            	}
	          }, 
		{
			            // data: 7,  // ExcerptPostBody
			            // render: function (data, type) {
			            //   return data ? '<span title="' + data + '">' + data + '</span>' : '';
			            // }
		 data: 7,
			    render: function (data, type) {
			      if (!data) return '';
			      const short = data.substring(0, 100);
			      return `<span title="${data.replace(/"/g, '&quot;')}">${short}${data.length > 100 ? '…' : ''}</span>`;
			    }
	          },
		{
	        data: 6,
		            render: function (data) {
		              return data.trim() ? '✔️' : '❌';
		            }
		}, 
		{
		            // data: 6,  // WikiPostBody (HTML)
		            // className: 'body-html',
		            // render: function (data, type) {
		            //   return type === 'display' ? data : data;
		            // }
		 data: 6,
			    className: 'body-html',
			    render: function (data, type) {
				      if (!data) return '';
				      const tempDiv = document.createElement("div");
				      tempDiv.innerHTML = data;
				      const plainText = tempDiv.textContent || tempDiv.innerText || "";
				      const short = plainText.substring(0, 100).replace(/"/g, '&quot;');
				      return `<span title="${plainText.replace(/"/g, '&quot;')}">${short}${plainText.length > 100 ? '…' : ''}</span>`;
			    }
	          },
		{
		    data: 2,
			    orderable: false,
			    searchable: false,
			    render: function (data) {
			      const url = `https://stackoverflow.com/tags/${encodeURIComponent(data)}/info`;
			      return `<a href="${url}" target="_blank">
			                <button type="button" class="btn btn-dark">Explore</button>
			              </a>`;
			    }
		  }
        ],
        initComplete: function () {
          buildAlphabetNav(this.api());
        }
      });
function buildAlphabetNav(api) {
	const alphabet = {};
	// const tagNameColumnIndex = api.column('TagName:name').index();
	const tagNameColumnIndex =2;
  	api.rows().every(function () {
	      const tag = this.data()[tagNameColumnIndex];
	    // const tag = this.data()[2]; // TagName
	    if (!tag) return;
	    const firstChar = tag[0].toUpperCase();
	    alphabet[firstChar] = true;
	  });

	  const specialChars = Object.keys(alphabet).filter(ch => !/[A-Z0-9]/.test(ch)).sort();
	  const letters = Object.keys(alphabet).filter(ch => /[A-Z]/.test(ch)).sort();
	  const digits = Object.keys(alphabet).filter(ch => /[0-9]/.test(ch)).sort();
	
	  const navelements = specialChars.concat(letters).concat(digits);
	  const $nav = $('#alphabet-nav');
	  $nav.empty();

		// Add "All" button
	  // $('<button type="button" class="btn btn-outline-dark active" data-letter="">All</button>').appendTo($nav);+
	  $('<button type="button" class="btn btn-outline-dark active" data-letter="">All</button>').data( 'letter', '' ).appendTo($nav);
		  
	
	  // Add buttons for each character
	  navelements.forEach(letter => {
	    // $(`<button type="button" class="btn btn-outline-dark" data-letter="${letter}">${letter}</button>`).appendTo($nav);
	    $(`<button type="button" class="btn btn-outline-dark" data-letter="${letter}">${letter}</button>`). data( 'letter', letter ).appendTo($nav);
		  
		   
	  });

			  // // Button click event
			  // $nav.on('click').on('click', 'button', function () {
			  //   $nav.find('button').removeClass('active');
			  //   $(this).addClass('active');
			
			  //   const letter = $(this).data('letter');
			  //   // const regex = letter ? '^' + letter.replace(/[.*+?^${}()|[\]\\]/g, '\\$&') : '';
			
			  //   // ✅ Use column index + regex search
			  //   // api.column(tagNameColumnIndex).search(regex, true, false).draw();
				 //        api.column(2).search(letter ? '^' + letter : '', true, false).draw();
			  // });

	  // Button click event
	  $nav.on('click').on('click', 'button', function () {
		$nav.find('button').removeClass('active');
		$(this).addClass('active');
		console.log("inside on click");
		alphabetSearch = $(this).data('letter');
		console.log(alphabetSearch);
		// $('#tagsTable').dataTable().fnFilter("^"+_alphabetSearch, 0, true).draw();
	        $nav.find( '.active' ).removeClass( 'active' );
	        $(this).addClass( 'active' );
	        _alphabetSearch = $(this).data('letter');
	        table.draw();
		   api
	        .columns(2)
	        .search(alphabetSearch )
	        .draw();

		  table.columns(tagNameColumnIndex).search(alphabetSearch, true, false).draw();

	  
//   var table = $('#example').DataTable();
//     var alphabet = $('<div class="alphabet"/>').append( 'Search: ' );
//     $('<span class="clear active"/>')
//         .data( 'letter', '' )
//         .html( 'None' )
//         .appendTo( alphabet );
//     for ( var i=0 ; i<26 ; i++ ) {
//         var letter = String.fromCharCode( 65 + i );
//         $('<span/>')
//             .data( 'letter', letter )
//             .html( letter )
//             .appendTo( alphabet );
//     }
//     alphabet.insertBefore( table.table().container() );
//     alphabet.on( 'click', 'span', function () {
//         alphabet.find( '.active' ).removeClass( 'active' );
//         $(this).addClass( 'active' );
//         _alphabetSearch = $(this).data('letter');
//         table.draw();
//     } );
// }

     
    });
}
    });
  </script>
<!--   <script>

  

    
// $(document).ready(function(){
//   new DataTable('#example', {
//     ajax: '../arrays.txt'
// });
// }); 

var _alphabetSearch = '';
 
$.fn.dataTable.ext.search.push( function ( settings, searchData ) {
    if ( ! _alphabetSearch ) {
        return true;
    }
 
    if ( searchData[0].charAt(0) === _alphabetSearch ) {
        return true;
    }
 
    return false;
} );
 
 
$(document).ready(function() {
    // var table = $('#example').DataTable();
 var table =  new DataTable('#example', {
    // ajax: '../arrays.txt'
    ajax: '../MinimalChangesData.txt',
    dataSrc: '',            // Because it's a flat array
        columns: [
          { data: 2 }, // TagName
          { data: 3 }, // TagCount
          { data: 5 }, // ExcerptPostBody
          { data: 7 }  // WikiPostBody
        ]
});
    var alphabet = $('<div class="alphabet"/>').append( 'Search: ' );
 
    $('<span class="clear active"/>')
        .data( 'letter', '' )
        .html( 'All' )
        .appendTo( alphabet );


    $('<span/>')
        .data( 'number', '' )
        // .html( 'All' )
        .appendTo( alphabet );

 console.log('letter');
  
    for ( var i=0 ; i<26 ; i++ ) {
        var letter = String.fromCharCode( 65 + i );
 console.log(letter);
        $('<span/>')
            .data( 'letter', letter )
            .html( letter )
            .appendTo( alphabet );
    }

   console.log('number');
 for ( var x=32 ; x<65 ; x++ ) {
   
        var number = String.fromCharCode(x );
 console.log(number);
 
 
 
 
        $('<span/>')
            .data( 'number', number )
            .html( number )
            .appendTo( alphabet ); 
    }
    alphabet.insertBefore( table.table().container() );
 
    alphabet.on( 'click', 'span', function () {
        alphabet.find( '.active' ).removeClass( 'active' );
        $(this).addClass( 'active' );
 
        _alphabetSearch = $(this).data('letter');
        _alphabetSearch = $(this).data('number');
      
        table.draw();
    } );
} );
  </script> -->
</html>
